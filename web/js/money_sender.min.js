function MoneySenderCtrl(a,c){var b=this;c.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8";c.defaults.headers.post["X-Requested-With"]="XMLHttpRequest";c.defaults.transformRequest=[function(e){var f=[];for(var d in e){f.push(encodeURIComponent(d)+"="+encodeURIComponent(e[d]))}return f.join("&")}];b.sender=null;b.receivers=[];b.receiver=null;b.amount=0;b.results=[];b.changeSender=function(){var d=[];b.users.forEach(function(e){if(e.id!=b.sender){d.push(e)}});b.receivers=d;b.receiver=b.receivers[0].id};b.sendMoney=function(){var e=b.findUserIndex(b.sender);var f=b.findUserIndex(b.receiver);var d=b.amount;if((d<=0)||(d>b.users[e].balance)){alert("Сумма должна быть в пределах от 0 до "+b.users[e].balance)}else{c.post("/ajax/send-money",{sender:b.sender,receiver:b.receiver,amount:d,_csrf:yii.getCsrfToken()}).then(function(g){if(g.data.success==true){b.users[e].balance-=d;b.users[f].balance=parseFloat(b.users[f].balance)+parseFloat(d)}angular.element("#result").removeClass("hidden");b.results.push({sender:b.users[e].name,receiver:b.users[f].name,amount:d,message:g.data.error});console.log(g.data.error)})}};b.findUserIndex=function(f){var e=0,d=0;b.users.forEach(function(g){if(g.id==f){d=e;return d}e++});return d};c.get("/ajax/get-users").then(function(d){b.users=d.data.users;b.sender=b.users[0].id;b.changeSender()})}var msender=angular.module("msender",[]);msender.controller("MoneySenderCtrl",["$scope","$http",MoneySenderCtrl]);